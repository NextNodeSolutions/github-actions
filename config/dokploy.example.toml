# =============================================================================
# Dokploy Project Configuration
# =============================================================================
# Copy this file to your project root as 'dokploy.toml'
# Only override what differs from defaults in dokploy-defaults.toml
# See: https://github.com/nextnode-solutions/github-actions/blob/main/config/dokploy-defaults.toml
# =============================================================================

# REQUIRED: Unique project identifier
name = "my-project"

# REQUIRED for deployments: Production domain (enables PR previews)
# - Production: my-project.com
# - Development: dev.my-project.com
# - Preview PR #42: pr-42.my-project.com
domain = "my-project.com"

# =============================================================================
# BUILD OVERRIDES (optional)
# =============================================================================
# Uncomment and modify only what differs from defaults

# [build]
# type = "dockerfile"           # dockerfile | nixpacks | buildpacks | static
# dockerfile = "Dockerfile"     # Path to Dockerfile
# context = "."                 # Build context directory
# target = "production"         # Multi-stage build target

# =============================================================================
# RESOURCE OVERRIDES (optional)
# =============================================================================

# [resources]
# memory = "1Gi"                # Memory request
# cpu = 1                       # CPU request (cores)
# memory_limit = "2Gi"          # Memory hard limit
# cpu_limit = 2                 # CPU hard limit

# =============================================================================
# HEALTH CHECK OVERRIDES (optional)
# =============================================================================

# [healthcheck]
# enabled = true
# path = "/api/health"          # Custom health endpoint
# port = 8080                   # Application port
# interval = 30                 # Check interval (seconds)
# timeout = 10                  # Check timeout (seconds)
# retries = 3                   # Retry count before unhealthy
# start_period = 40             # Grace period on startup (seconds)

# =============================================================================
# SCALE-TO-ZERO OVERRIDES (optional)
# =============================================================================
# Dev and preview environments scale to 0 after idle_timeout by default
# Sablier shows a loading page while container starts on-demand

# [scale_to_zero]
# enabled = true                  # Enabled by default for dev/preview
# idle_timeout = "1h"             # Scale down after 1 hour (default: 30m)
# session_duration = "1h"         # Stay awake for 1 hour (default: 30m)
# startup_timeout = "3m"          # Wait up to 3 minutes (default: 2m)
# theme = "ghost"                 # Loading page: hacker-terminal, ghost, shuffle

# Disable scale-to-zero for a specific environment:
# [environments.development]
# scale_to_zero = false           # Keep dev always running

# =============================================================================
# DEDICATED VPS (optional)
# =============================================================================
# Provision a dedicated Hetzner VPS for this project
# When enabled, ALL environments deploy on this VPS

# [vps]
# enabled = true                # Provision dedicated VPS
# name = "my-project-worker"    # VPS name (default: {project-name}-worker)
# type = "cx23"                 # Hetzner: cx23, cx33, cx43, cx53, cax11, cax21...
# location = "fsn1"             # fsn1, nbg1, hel1, ash, hil, sin
# has_volume = true             # Create persistent volume (default: true)
# volume_size = 10              # Volume size in GB (default: 10)

# =============================================================================
# COMPOSE DEPLOYMENT (optional)
# =============================================================================
# Deploy using docker-compose.yml instead of building a Docker image
# When enabled, the [build] section is ignored

# [compose]
# enabled = true                # Enable compose deployment mode
# file = "docker-compose.yml"   # Path to compose file
#
# # File mounts - files to upload to Dokploy's /files directory
# # These are created as Dokploy File Mounts before deployment
# # In your docker-compose.yml, reference them as: ../files/<target>
# [[compose.mounts]]
# source = "config/nginx.conf"  # Local file path (relative to repo root)
# target = "nginx.conf"         # Target filename in Dokploy's /files directory

# =============================================================================
# SERVICES (optional - future implementation)
# =============================================================================
# Provision managed services for this project

# [services.postgres]
# enabled = true
# version = "16"
# size = "small"                # small (1GB), medium (4GB), large (8GB)

# [services.redis]
# enabled = true
# version = "7"
# size = "small"

# [services.minio]
# enabled = true
# bucket = "uploads"

# =============================================================================
# ENVIRONMENT OVERRIDES (optional)
# =============================================================================

# [environments.production]
# replicas = 2

# [environments.development]
# replicas = 1

# [environments.preview]
# replicas = 1
# cleanup_on_merge = true       # Auto-cleanup when PR is merged

# --- Deploy on an EXISTING VPS (no provisioning) ---
# Use when you want to deploy on a VPS that already exists

# [environments.development]
# server = "custom"             # Required: use custom server
# vps = "existing-vps-name"     # Required: name of existing VPS

# [environments.production]
# server = "custom"             # Required: use custom server
# vps = "existing-vps-name"     # Required: name of existing VPS
